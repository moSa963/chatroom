import{a as B,g as T,s as b,c as v,m as k,z as m,b as z,U as I,V as P,r as D,u as E,j as s,d as M,e as F,T as O,B as U,t as S,h as _,i as N,R as u,D as A,l as W,Q as $,P as L,W as G,A as V}from"./index-Y91MOtxq.js";import{p as q}from"./Permissions-C4dgcXcN.js";import{B as X}from"./Select-It-sKpq1.js";import{P as Y}from"./useSlot-BWqUzJVS.js";import{F as C,a as x,I as J}from"./FormGrid-B-uXa9jQ.js";import{T as y}from"./TextField-CoweyKZi.js";import{S as Q}from"./SwitchBase-CxQ56Ylu.js";import{U as H}from"./UpdateImage-CGhJn9cJ.js";import"./react-is.production.min-45l22EfV.js";import"./useTheme-BuMe12sB.js";import"./InputBase-DrHRt9EZ.js";import"./useFormControl-BT_-7oMV.js";import"./ownerWindow-DIR61fab.js";import"./List-3WCtkJeu.js";import"./useControlled-CKAdOX-G.js";import"./Box-C7Q6lQnf.js";import"./Divider-6e9HeHrJ.js";import"./dividerClasses-CJRI5ykF.js";import"./LinearProgress-DkWLgsYn.js";import"./Avatar-6iMMLUcH.js";import"./ButtonGroup-CLipGnnu.js";function K(e){return T("MuiSwitch",e)}const o=B("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Z=e=>{const{classes:t,edge:a,size:i,color:n,checked:r,disabled:c}=e,h={root:["root",a&&`edge${v(a)}`,`size${v(i)}`],switchBase:["switchBase",`color${v(n)}`,r&&"checked",c&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},g=F(h,K,t);return{...t,...g}},ee=b("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.edge&&t[`edge${v(a.edge)}`],t[`size${v(a.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${o.thumb}`]:{width:16,height:16},[`& .${o.switchBase}`]:{padding:4,[`&.${o.checked}`]:{transform:"translateX(16px)"}}}}]}),te=b(Q,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.switchBase,{[`& .${o.input}`]:t.input},a.color!=="default"&&t[`color${v(a.color)}`]]}})(k(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${o.checked}`]:{transform:"translateX(20px)"},[`&.${o.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${o.checked} + .${o.track}`]:{opacity:.5},[`&.${o.disabled} + .${o.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${o.input}`]:{left:"-100%",width:"300%"}})),k(({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:m(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(z(["light"])).map(([t])=>({props:{color:t},style:{[`&.${o.checked}`]:{color:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:m(e.palette[t].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${o.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t}DisabledColor`]:`${e.palette.mode==="light"?I(e.palette[t].main,.62):P(e.palette[t].main,.55)}`}},[`&.${o.checked} + .${o.track}`]:{backgroundColor:(e.vars||e).palette[t].main}}}))]}))),ae=b("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(k(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`}))),se=b("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(k(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),j=D.forwardRef(function(t,a){const i=E({props:t,name:"MuiSwitch"}),{className:n,color:r="primary",edge:c=!1,size:h="medium",sx:g,...f}=i,l={...i,color:r,edge:c,size:h},d=Z(l),p=s.jsx(se,{className:d.thumb,ownerState:l});return s.jsxs(ee,{className:M(d.root,n),sx:g,ownerState:l,children:[s.jsx(te,{type:"checkbox",icon:p,checkedIcon:p,ref:a,ownerState:l,...f,classes:{...d,root:d.switchBase}}),s.jsx(ae,{className:d.track,ownerState:l})]})}),ie=({action:e,open:t,onClose:a,message:i})=>{const n=()=>{e&&e(),a&&a()};return s.jsx(X,{sx:{color:"#fff",zIndex:r=>r.zIndex.drawer+5},open:t,children:s.jsxs(Y,{sx:{display:"flex",flexDirection:"column",width:"100%",maxWidth:500,borderRadius:5,p:2},children:[s.jsxs(O,{variant:"h5",children:[" ",i]}),s.jsxs(U,{sx:{display:"flex",justifyContent:"end",width:"100%"},children:[s.jsx(S,{onClick:a,children:"No"}),s.jsx(S,{color:"error",onClick:n,children:"Yes"})]})]})})},ne=({room:e})=>{const t=_(N),[a,i]=u.useState(),n=A(),r=W();return s.jsxs(u.Fragment,{children:[a&&s.jsx(ie,{open:!0,action:()=>re(e,n,r),message:"Are you sure you want to delete this room? this action is irreversible",onClose:()=>i(!1)}),q.owner(e,t)&&s.jsx(S,{variant:"contained",color:"error",onClick:()=>i(!0),children:"DELETE"})]})},re=async(e,t,a)=>{(await $("api/rooms/"+e.id,"DELETE")).ok&&(a(L(e)),t("/dashboard/rooms"))},oe=({room:e,setRoom:t})=>{var l,d;const[a,i]=u.useState({}),[n,r]=u.useState({}),[c,h]=u.useState(!1),g=(p,R)=>{a[p]=R,i({...a})},f=()=>{ce(e,a,r,t,h)};return s.jsxs(C,{title:"Room info",onSave:f,disabled:c,processing:c,children:[s.jsx(x,{label:"Name:",children:s.jsx(y,{size:"small",fullWidth:!0,value:(a==null?void 0:a.name)||(e==null?void 0:e.name)||"",onChange:p=>g("name",p.currentTarget.value),error:(l=n==null?void 0:n.name)==null?void 0:l.at(0)})}),s.jsx(x,{label:"Description:",children:s.jsx(y,{size:"small",fullWidth:!0,value:(a==null?void 0:a.description)||(e==null?void 0:e.description)||"",onChange:p=>g("description",p.currentTarget.value),error:(d=n==null?void 0:n.description)==null?void 0:d.at(0)})})]})},ce=async(e,t,a,i,n)=>{n(!0);const r=await $("api/rooms/"+(e==null?void 0:e.id),"POST",t);if(n(!1),r.ok){const h=await r.json();i(h.data);return}const c=await r.json();a(c.errors)},le=({initValue:e,onChange:t,adornment:a})=>{const[i,n]=u.useState(e);return u.useEffect(()=>{if(!i)return;const r=setTimeout(()=>t&&t(parseInt(i)),1e3);return()=>clearTimeout(r)},[i,t]),s.jsx(y,{type:"number",min:0,size:"small",fullWidth:!0,value:i,onChange:r=>n(r.currentTarget.value),InputProps:{endAdornment:s.jsx(J,{position:"end",children:a})}})},de=({room:e,setRoom:t})=>s.jsxs(C,{title:"Room options",children:[s.jsx(x,{label:"Slow Mode:",children:s.jsx(le,{initValue:e==null?void 0:e.slow_mode,onChange:a=>a!==(e==null?void 0:e.slow_mode)&&w(e,{slow_mode:a},t),adornment:"Second"})}),s.jsx(x,{label:"Private:",children:s.jsx(j,{checked:!!(e!=null&&e.is_private),onClick:()=>w(e,{is_private:e!=null&&e.is_private?0:1},t)})}),s.jsx(x,{label:"Locked:",description:"When the room is locked, users cannot join or request to join",children:s.jsx(j,{checked:!!(e!=null&&e.locked),onClick:()=>w(e,{locked:e!=null&&e.locked?0:1},t)})}),s.jsx(x,{label:"Read only:",noDivider:!0,description:"In read-only mode, new members will not get write permission automatically.",children:s.jsx(j,{checked:!!(e!=null&&e.read_only),onClick:()=>w(e,{read_only:e!=null&&e.read_only?0:1},t)})})]}),w=async(e,t,a)=>{const i=await $(`api/rooms/${e==null?void 0:e.id}`,"POST",t);if(i.ok){const n=await i.json();a(n.data);return}},Pe=()=>{const[e,t]=G();return s.jsxs(u.Fragment,{children:[s.jsx(H,{src:`${V}api/rooms/${e==null?void 0:e.id}/image`,link:`api/rooms/${e==null?void 0:e.id}/image`,caption:"Must be JPEG, PNG, or GIF and cannot exceed 10MB"}),s.jsx(oe,{room:e,setRoom:t}),s.jsx(de,{room:e,setRoom:t}),s.jsx(ne,{room:e})]})};export{Pe as default};
